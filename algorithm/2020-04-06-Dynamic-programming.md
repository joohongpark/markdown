# Recursion 과 Dynamic Programming

recursion이란 한국어로 반복, 되풀이를 위미한다. 프로그래밍에서 recursion이란 보통 특정 함수 내부 로직에서 자기 자신의 함수를 호출해 작업을 수행하는 방식을 의미한다. 이러한 방식이 적용된 함수를 재귀 함수(Recursion Function)라 부른다.

프로그래밍에서 재귀 함수가 사용되는 예시는 매우 다양한데 점화식으로 구현되는 관계식을 함수로 구현될 때, 혹은 커다란 문제를 분할하여 해결할 때 주로 사용된다. 재귀 함수를 설명할 때 가장 흔히 사용되는 피보나치 수열을 이용해 설명하겠다.

피보나치 수열은 초기값과 점화식으로 정의되는 수열이며 정의는 다음과 같다.

> $f(0) = 0$
>
> $f(1) = 1$
>
> $f(n) = f(n-1) + f(n-2)$

여기서 f(x)를 프로그래밍 언어로 구현할 때 재귀적으로 구현하면 다음과 같다. (예제 언어 : C)

> ```c
> int fibonacci(int n)
> {
>   if(n == 0)
>   {
>     return 0;
>   }
>   else if (n == 1)
>   {
>     return 1;
>   }
>   else
>   {
>     return fibonacci(n-1) + fibonacci(n-2);
>   }
> }
> ```

인수가 0 혹은 1일 경우 상수값을 return 해 주며, 2부터는 함수 본인을 재귀적으로 호출한다. 해당 함수의 실행 과정을 나타내면 다음과 같다.

> 예를 들어 fibonacci(4)를 실행한다면
>
> ```
> fibonacci(4) // #1
> ├─ fibonacci(3) // #2
> │   ├─fibonacci(2) // #3
> │   │   ├─fibonacci(1) = 1 // #4
> │   │   └─fibonacci(0) = 0 // #5
> │   └─fibonacci(1) = 1 // #6
> └─ fibonacci(2) // #7
>     ├─fibonacci(1) = 1 // #8
>     └─fibonacci(0) = 0 // #9
> ```
>
> 위와 같이 실행될 것이다.

위 구조를 살펴보면 의도한 대로 동작하는 것을 알 수 있지만 동시에 불필요한 연산(동일한 인수의 함수 콜)을 여러번 수행하는 것을 볼 수 있다. 예를 들어 n = 2인 함수는 두번 호출되었으며 이는 불필요한 재귀 연산이 발생하였다고 볼 수 있을 것이다.

해당 연산 수행 시 내부 함수 콜스택에 함수가 계속 쌓이게 되는 결과가 발생한다. 따라서 일반적인 데스크탑 컴퓨터 환경 기준으로 n = 100 만 되도 불필요한 함수 콜이 엄청나게 많이 발생하고 스택에 중복된 함수가 쌓이게 되어 콜스택이 오버플로우 되어 정상적인 실행 결과를 얻기 힘들게 된다.

해당 문제점은 피보나치 수열을 iteration(반복 - for 문 등을 이용한 반복문)형태로 구현하여 연산 횟수를 줄일 수 있는 방법이 존재한다.

예를 들면, f(n)에 대해 n = 0, 1, 2, ...에 대한 결과를 n이 0, 1에 대하여 순서대로 리스트에 저장해 놓고 n = 2 이상부터는 리스트에 저장된 값을 참조하여 연산하는 법으로 구현 가능하다.

예제는 다음과 같다.

> ```c
> unsigned long fibonacci_iter(int n) {
>     int answer = 0;
>     unsigned long fib[3] = {0, 1, 0};
>     for (int i = 1; i < n; i++)
>     {
>         fib[(i+1)%3] = fib[(i+2)%3] + fib[i%3];
>     }
>     answer = fib[n % 3];
>     return answer;
> }
> ```
>
> 다음과 같이 구현한다면 n에 대한 연산 반복은 n번만 수행하게 된다. 리스트는 현재 연산 값과 이전, 이이전 값을 사용하므로 순환적으로 대입하고 참조되도록 구현된 예제이다.

이와 같이 구현할 수도 있지만 보통은 재귀 함수 형태를 사용하는 것이 코딩하는데 편할 것이다.

그러면 위의 트리 구조에서 동일한 인수가 대입되어 불필요한 연산이 들어가는 부분을 제거하는 것이 중요한데 이를 Dynamic Programming(동적 프로그래밍)이라고 한다.

